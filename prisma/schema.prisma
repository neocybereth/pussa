// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum Role {
  TEACHER
  STUDENT
}

enum PaymentStatus {
  PAID
  UNPAID
}

model User {
  id                String            @id @default(cuid())
  email             String            @unique
  password          String
  name              String
  role              Role              @default(STUDENT)
  createdAt         DateTime          @default(now())
  updatedAt         DateTime          @updatedAt
  assignedExercises StudentExercise[]
  scheduledClasses  ScheduledClass[]
}

model Exercise {
  id          String            @id @default(cuid())
  title       String
  description String?
  audioUrl    String
  audioKey    String
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
  assignedTo  StudentExercise[]
}

model StudentExercise {
  id         String   @id @default(cuid())
  studentId  String
  exerciseId String
  assignedAt DateTime @default(now())
  notes      String?
  student    User     @relation(fields: [studentId], references: [id], onDelete: Cascade)
  exercise   Exercise @relation(fields: [exerciseId], references: [id], onDelete: Cascade)

  @@unique([studentId, exerciseId])
}

model ScheduledClass {
  id            String        @id @default(cuid())
  studentId     String
  title         String
  startTime     DateTime
  endTime       DateTime
  paymentStatus PaymentStatus @default(UNPAID)
  notes         String?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  student       User          @relation(fields: [studentId], references: [id], onDelete: Cascade)
}

model SiteSettings {
  id           String  @id @default(cuid())
  teacherName  String?
  teacherBio   String?
  teacherPhoto String?
  pricing      Json?
  contactInfo  Json?
}
